Metadata-Version: 2.4
Name: pangu
Version: 0.1.0
Summary: Add your description here
Requires-Python: >=3.12
Description-Content-Type: text/markdown
Requires-Dist: ai-models>=0.7.2
Requires-Dist: ai-models-panguweather>=0.0.7
Requires-Dist: cfgrib>=0.9.15.1
Requires-Dist: gdown>=5.2.0
Requires-Dist: netcdf4>=1.7.3
Requires-Dist: numpy>=2.4.0
Requires-Dist: onnxruntime-gpu>=1.23.2
Requires-Dist: pytest>=9.0.2
Requires-Dist: pytest-cov>=7.0.0
Requires-Dist: pyyaml>=6.0.3
Requires-Dist: torch>=2.9.1
Requires-Dist: xarray>=2025.12.0
Requires-Dist: cdsapi>=0.7.5
Requires-Dist: gdex-api-client
Requires-Dist: cdo>=1.6.1
Requires-Dist: timm>=1.0.22
Requires-Dist: ruff>=0.14.10
Requires-Dist: radon>=6.0.1
Requires-Dist: isort>=7.0.0

# Pangu-Weather

åŸºæ–¼ 3D Swin Transformer çš„å…¨çƒæ°£è±¡é å ±æ¨¡å‹ã€‚

## ğŸŒ å°ˆæ¡ˆç°¡ä»‹

Pangu-Weather æ˜¯ ECMWF å¿«é€Ÿé å ±ç­‰ç´šçš„ AI æ°£è±¡æ¨¡å‹ï¼Œä½¿ç”¨ Earth-Specific 3D Swin Transformer æ¶æ§‹ï¼Œå¯åœ¨æ•¸ç§’å…§å®Œæˆ 7 å¤©çš„å…¨çƒå¤©æ°£é å ±ã€‚

**æ ¸å¿ƒç‰¹é»**:
- ğŸ“ˆ **160M åƒæ•¸** çš„ 3D Swin Transformer
- ğŸŒ **Earth-Specific Bias** è™•ç†çƒé¢ç¶²æ ¼ä¸å‡å‹»æ€§
- âš¡ **å¿«é€Ÿæ¨è«–** æ•¸ç§’å®Œæˆ 7 å¤©é å ±
- ğŸ”§ **æ¨¡çµ„åŒ–è¨­è¨ˆ** æ˜“æ–¼æ“´å±•èˆ‡ç¶­è­·

## ğŸ“¦ å®‰è£

```bash
# ä½¿ç”¨ uv å®‰è£ä¾è³´
uv sync

# æˆ–ä½¿ç”¨ pip
pip install -e .
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. è³‡æ–™æ”¶é›†

```bash
# ä¸‹è¼‰ ERA5 è³‡æ–™
python scripts/data_prepare.py --config configs/data_prepare.yaml
```

### 2. æ¨¡å‹è¨“ç·´

```bash
# é–‹å§‹è¨“ç·´
python scripts/train.py --config configs/train.yaml
```

### 3. æ¨è«–

```bash
# åŸ·è¡Œæ¨è«–
python scripts/inference.py --input data/input.nc --output data/output.nc
```

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
pangu/
â”œâ”€â”€ src/pangu/
â”‚   â”œâ”€â”€ data/          # è³‡æ–™æ”¶é›†æ¨¡çµ„ (ERA5, GFS)
â”‚   â”œâ”€â”€ training/      # è¨“ç·´æ¨¡çµ„ (Dataset, Trainer, Loss)
â”‚   â”œâ”€â”€ models/        # æ¨¡å‹æ¶æ§‹ (3D Swin Transformer)
â”‚   â”œâ”€â”€ inference/     # æ¨è«–æ¨¡çµ„ (å‰å¾Œè™•ç†)
â”‚   â””â”€â”€ utils/         # å·¥å…· (I/O, Transforms, Logger)
â”œâ”€â”€ tests/             # æ¸¬è©¦
â”œâ”€â”€ configs/           # é…ç½®æª”æ¡ˆ
â”œâ”€â”€ scripts/           # åŸ·è¡Œè…³æœ¬
â”œâ”€â”€ data/              # è³‡æ–™ç›®éŒ„
â””â”€â”€ doc/               # æ–‡ä»¶
```

## ğŸ› ï¸ æ¨¡å‹æ¶æ§‹

```
è¼¸å…¥:
â”œâ”€â”€ Upper Air: (5, 13, 721, 1440) - Z, Q, T, U, V @ 13 å£“åŠ›å±¤
â””â”€â”€ Surface:   (4, 721, 1440)     - MSLP, U10, V10, T2M

æ¨¡å‹:
â”œâ”€â”€ PatchEmbedding (Conv3d/2d)
â”œâ”€â”€ Encoder
â”‚   â”œâ”€â”€ Layer1 (2 blocks, dim=192)
â”‚   â””â”€â”€ DownSample â†’ (8, 180, 91)
â”œâ”€â”€ Bottleneck
â”‚   â”œâ”€â”€ Layer2 (6 blocks, dim=384)
â”‚   â””â”€â”€ Layer3 (6 blocks, dim=384)
â”œâ”€â”€ Decoder
â”‚   â”œâ”€â”€ UpSample â†’ (8, 360, 181)
â”‚   â””â”€â”€ Layer4 (2 blocks, dim=192)
â””â”€â”€ PatchRecovery (ConvTranspose3d/2d)

è¼¸å‡º: åŒè¼¸å…¥å½¢ç‹€
```

## ğŸ“Š è®Šæ•¸èªªæ˜

**Upper Air (5 è®Šæ•¸ Ã— 13 æ°£å£“å±¤)**:
- Z: ä½å‹¢é«˜åº¦
- Q: æ¯”æ¿•
- T: æº«åº¦
- U: ç·¯å‘é¢¨
- V: ç¶“å‘é¢¨

**Surface (4 è®Šæ•¸)**:
- MSLP: å¹³å‡æµ·å¹³é¢æ°£å£“
- U10: 10m ç·¯å‘é¢¨
- V10: 10m ç¶“å‘é¢¨
- T2M: 2m æº«åº¦

## ğŸ§ª æ¸¬è©¦

```bash
# åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
pytest tests/

# åŸ·è¡Œç‰¹å®šæ¸¬è©¦
pytest tests/test_model_simple.py -v
```

## ğŸ“š æ–‡ä»¶

- [è³‡æ–™æ”¶é›†æŒ‡å—](doc/data_collection.md)
- [è¨“ç·´æŒ‡å—](doc/training_guide.md)
- [æ¨è«–æŒ‡å—](doc/inference_guide.md)

## ğŸ“„ æˆæ¬Š

MIT License

## ğŸ™ è‡´è¬

åŸºæ–¼ [Pangu-Weather](https://github.com/198808xc/Pangu-Weather) è«–æ–‡å¯¦ä½œã€‚
